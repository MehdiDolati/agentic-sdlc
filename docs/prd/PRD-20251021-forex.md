Sure, here's a comprehensive Product Requirements Document (PRD) for the "forex" project, based on the provided conversation.

---

**Product Requirements Document (PRD)**

**Project Name:** Forex Algo Trading Software

**Version:** 1.0
**Date:** October 26, 2023
**Author:** AI Assistant

---

**1. Executive Summary**

This document outlines the requirements for the development of "Forex," a fully automated algorithmic trading software built on the MQL4 platform. The objective of Forex is to provide retail forex traders with a reliable and autonomous tool for executing trading strategies, thereby eliminating emotional biases, maximizing efficiency, and allowing for continuous market participation. The software aims to address the common challenges faced by manual traders, such as time constraints, psychological errors, and the need for constant market monitoring.

---

**2. Project Overview**

**2.1. Project Description**
"Forex" is an automated algorithmic trading software designed to operate within the MetaTrader 4 (MT4) platform using MQL4 (MetaQuotes Language 4). It will autonomously identify trading opportunities, execute trades, and manage positions based on pre-defined strategies and parameters. The primary goal is to provide a "set-and-forget" solution for retail forex traders looking to leverage algorithmic trading without requiring advanced programming knowledge.

**2.2. Problem Statement**
Manual forex trading presents several challenges:
*   **Emotional Bias:** Fear, greed, and impatience often lead to irrational trading decisions.
*   **Time Constraints:** Manual traders need to constantly monitor markets, which is time-consuming and often impractical.
*   **Execution Delays:** Manual order entry can lead to missed opportunities or sub-optimal entry/exit points.
*   **Lack of Discipline:** Deviating from a trading plan is common due to psychological factors.
*   **Scalability:** Managing multiple strategies or currency pairs manually is difficult.

**2.3. Solution**
Forex will provide a solution by:
*   **Automating Trade Execution:** Eliminating human emotions from the trading process.
*   **24/5 Market Monitoring:** Continuously scanning markets and executing trades without human intervention.
*   **Precise Entry/Exit:** Executing trades instantly based on defined criteria.
*   **Strict Adherence to Strategy:** Enforcing discipline by following pre-coded rules.
*   **Scalability:** Potentially allowing for the management of multiple strategies or currency pairs simultaneously.

**2.4. Target Users**
The primary target users are:
*   **Retail Forex Traders:** Individuals with some experience in forex trading who understand basic concepts but seek to automate their strategies.
*   **Part-time Traders:** Individuals who cannot dedicate full-time hours to market monitoring.
*   **Traders Seeking Discipline:** Those who struggle with emotional decision-making.
*   **Users of MetaTrader 4 (MT4):** Traders already familiar with and operating within the MT4 environment.

---

**3. Functional Requirements**

The software must be able to perform the following core functions:

**3.1. Strategy Implementation & Execution**
*   **FR-3.1.1:** The software shall support the implementation of a specific, pre-defined trading algorithm (to be specified in detail later, e.g., trend following, mean reversion, breakout).
*   **FR-3.1.2:** The software shall automatically identify buy/sell signals based on the implemented strategy's parameters.
*   **FR-3.1.3:** The software shall automatically place market, limit, and stop orders (Buy, Sell, Buy Limit, Sell Limit, Buy Stop, Sell Stop) based on strategy signals.
*   **FR-3.1.4:** The software shall automatically set Stop Loss (SL) and Take Profit (TP) levels for each trade based on pre-defined risk management rules.
*   **FR-3.1.5:** The software shall incorporate trailing stop functionality, if applicable to the strategy.
*   **FR-3.1.6:** The software shall manage open positions, including modifications to SL/TP, and closing positions based on strategy triggers.

**3.2. Risk & Money Management**
*   **FR-3.2.1:** The software shall allow users to define a fixed lot size or a percentage-based risk per trade (e.g., 1% of equity).
*   **FR-3.2.2:** The software shall automatically calculate the appropriate lot size based on defined risk parameters and SL distance.
*   **FR-3.2.3:** The software shall include a maximum daily drawdown limit, which, if hit, will disable further trading for the day.
*   **FR-3.2.4:** The software shall include a maximum open trades limit.

**3.3. Configuration & Customization**
*   **FR-3.3.1:** The software shall expose key strategy parameters (e.g., indicator periods, entry/exit thresholds) as external MQL4 inputs for user modification without code changes.
*   **FR-3.3.2:** The software shall allow users to enable or disable the automated trading functionality.
*   **FR-3.3.3:** The software shall allow users to specify trading hours or days (e.g., disable trading during news events or specific sessions).
*   **FR-3.3.4:** The software shall allow users to select specific currency pairs to trade.

**3.4. Logging & Monitoring**
*   **FR-3.4.1:** The software shall log all trading activities (order placement, modification, closure, errors) to the MT4 Experts tab.
*   **FR-3.4.2:** The software shall provide visual feedback on the chart (e.g., current trade status, SL/TP levels, entry signals).
*   **FR-3.4.3:** The software shall log critical errors (e.g., connection issues, order rejection) with clear messages.

**3.5. Platform Integration**
*   **FR-3.5.1:** The software shall seamlessly integrate with the MetaTrader 4 (MT4) terminal.
*   **FR-3.5.2:** The software shall correctly interpret real-time market data received from MT4 (price, time, indicators).

---

**4. Non-Functional Requirements**

**4.1. Performance**
*   **NFR-4.1.1:** Trade execution should occur with minimal latency, ideally within milliseconds of a signal generation, subject to broker and network conditions.
*   **NFR-4.1.2:** The software should operate efficiently without causing significant slowdowns or resource consumption within the MT4 terminal.

**4.2. Reliability**
*   **NFR-4.2.1:** The software should handle common error conditions gracefully (e.g., re-attempt order placement, log errors, notify user).
*   **NFR-4.2.2:** The software should be robust against temporary network disconnections and attempt to re-establish connection or manage open trades appropriately.
*   **NFR-4.2.3:** The software should be able to recover its state accurately after a platform restart or power outage (e.g., by recognizing existing open trades).

**4.3. Security**
*   **NFR-4.3.1:** The software shall not store or transmit sensitive user information (e.g., MT4 login credentials).
*   **NFR-4.3.2:** The software's code should be secure against common MQL4 vulnerabilities.

**4.4. Usability**
*   **NFR-4.4.1:** The external parameters (inputs) should be clearly named and intuitive for users to configure.
*   **NFR-4.4.2:** Logging messages should be clear, concise, and easy to understand for debugging and monitoring.

**4.5. Maintainability**
*   **NFR-4.5.1:** The MQL4 codebase should be well-structured, commented, and easy to understand for future modifications or debugging.

**4.6. Scalability**
*   **NFR-4.6.1:** The software should be designed to potentially manage multiple instances on different charts or currency pairs without significant performance degradation (though initial scope might focus on single instance).

---

**5. User Stories**

Here are some example user stories representing the needs of our target audience:

*   **As a retail forex trader,** I want to **automate my trading strategy** so that I can **remove emotional biases** from my decisions.
*   **As a part-time trader,** I want the software to **monitor the market 24/5 and execute trades automatically** so that I don't miss opportunities while I'm away.
*   **As a user concerned with risk,** I want to **define my maximum risk per trade as a percentage of my account equity** so that I can manage my capital responsibly.
*   **As a user who wants control,** I want to be able to **easily enable or disable the automated trading functionality** so that I can intervene if needed.
*   **As a user integrating into MT4,** I want the tool to **seamlessly operate within my existing MetaTrader 4 platform** so that I don't need to learn new software.
*   **As a user who wants to track performance,** I want the software to **log all trading activity and critical errors** so that I can review its performance and troubleshoot issues.
*   **As a user with specific market views,** I want to **specify which currency pairs the software trades** so that I can focus on markets I understand.
*   **As a user who wants to optimize,** I want to be able to **change key strategy parameters directly from the MT4 inputs** so that I can backtest and optimize without modifying code.

---

**6. Acceptance Criteria**

Each functional requirement will have specific acceptance criteria. Below are examples:

*   **AC-FR-3.1.1 (Strategy Implementation):** The software correctly identifies entry and exit signals in backtesting and live trading according to the pre-defined strategy rules (e.g., indicator crossover, price action pattern).
*   **AC-FR-3.1.3 (Automated Order Placement):** Upon a valid signal, the software successfully places a corresponding market, limit, or stop order with the broker and verifies its execution.
*   **AC-FR-3.1.4 (SL/TP Setting):** For every trade, the specified Stop Loss and Take Profit levels are set immediately upon order placement and are within acceptable broker limits.
*   **AC-FR-3.2.2 (Lot Size Calculation):** Given an account equity of $10,000 and a 1% risk-per-trade setting, with a 30-pip Stop Loss for EUR/USD, the software correctly calculates and places the trade with the appropriate lot size.
*   **AC-FR-3.3.1 (Parameter Customization):** Changes made to external MQL4 inputs (e.g., indicator period from 14 to 21) are immediately reflected in the strategy's behavior without requiring code recompilation.
*   **AC-FR-3.4.1 (Logging):** All executed trades, modifications, and closures are accurately recorded in the MT4 Experts tab, including timestamps and relevant details (order type, price, volume, SL/TP).
*   **AC-NFR-4.1.1 (Latency):** The average time from signal generation to order placement is consistently below 200 milliseconds under normal network conditions.
*   **AC-NFR-4.2.3 (Recovery):** If MT4 is unexpectedly closed and restarted with open trades, the expert advisor correctly identifies and manages those existing trades upon re-initialization.

---

**7. Technical Considerations**

**7.1. Development Language:** MQL4
**7.2. Platform:** MetaTrader 4 (MT4) Desktop Terminal
**7.3. Libraries/Dependencies:** Standard MQL4 libraries; no external DLLs or third-party libraries anticipated initially to maintain simplicity and compatibility.
**7.4. Data Sources:** Real-time and historical price data provided by the MT4 terminal and the connected broker.
**7.5. Order Types:** Market, Limit, Stop, Trailing Stop.
**7.6. Error Handling:** Robust error handling for broker rejections, connection issues, invalid parameters.
**7.7. Backtesting & Optimization:** The EA should be compatible with MT4's Strategy Tester for backtesting and optimization.
**7.8. Timeframe Compatibility:** The strategy should be designed to operate on a specified timeframe (e.g., H1, M30).
**7.9. Broker Compatibility:** While built for MT4, subtle differences in broker execution models (e.g., slippage, spread, fills) should be considered during testing.

---

**8. Timeline and Milestones**

This timeline is an initial estimate and subject to refinement after detailed strategy definition.

**Phase 1: Planning and Strategy Definition (Weeks 1-2)**
*   **Milestone 1.1:** Detailed definition of the core trading strategy (entry rules, exit rules, indicator specifics).
*   **Milestone 1.2:** Finalization of risk management parameters and money management rules.
*   **Milestone 1.3:** Complete functional specification for all MQL4 inputs.

**Phase 2: Core Development (Weeks 3-6)**
*   **Milestone 2.1:** Development of base MQL4 structure, order management functions (open, close, modify).
*   **Milestone 2.2:** Implementation of strategy entry and exit logic based on defined rules.
*   **Milestone 2.3:** Implementation of risk management (lot size calculation, SL/TP placement).
*   **Milestone 2.4:** Integration of logging and chart display functionalities.

**Phase 3: Testing & Debugging (Weeks 7-9)**
*   **Milestone 3.1:** Unit testing of individual functions and modules.
*   **Milestone 3.2:** Extensive backtesting using MT4 Strategy Tester with historical data.
*   **Milestone 3.3:** Optimization of key strategy parameters using Strategy Tester.
*   **Milestone 3.4:** Forward testing on a demo account in a simulated live environment.
*   **Milestone 3.5:** Resolution of all identified bugs and errors during testing.

**Phase 4: Documentation & Deployment Prep (Week 10)**
*   **Milestone 4.1:** Generation of comprehensive user manual for MQL4 inputs and usage.
*   **Milestone 4.2:** Final code review and commenting.
*   **Milestone 4.3:** Preparation for potential live (real account) deployment (post-demo testing verification).

**Estimated Total Project Duration:** 10 weeks (subject to strategy complexity and resource availability).

---
