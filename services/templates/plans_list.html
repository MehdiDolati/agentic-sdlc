{% extends "base.html" %}
{% block content %}
<h1>Plans</h1>
<div style="margin-bottom:12px;">
  <a href="/ui/requests/new" class="badge">New Plan</a>
</div>
<div class="card" style="margin-top:12px;">
  <form id="searchForm"
        hx-get="/ui/plans"
        hx-target="#results"
        hx-push-url="true"
        hx-trigger="submit, keyup delay:300ms from:#q">
    <div class="grid grid-2">
      <input id="q" name="q" value="{{ q or '' }}" placeholder="Search (goal, artifacts)...">
      <div style="display:flex; gap:8px; align-items:center;">
		<select name="owner">
		  <option value="" {{ 'selected' if owner=='' else '' }}>Owner: Any</option>
		  <option value="public" {{ 'selected' if owner=='public' else '' }}>public</option>
		  <option value="ui" {{ 'selected' if owner=='ui' else '' }}>ui</option>
		</select>
		<select name="status">
		  <option value="" {{ 'selected' if status=='' else '' }}>Status: Any</option>
		  <option value="new" {{ 'selected' if status=='new' else '' }}>new</option>
		  <option value="queued" {{ 'selected' if status=='queued' else '' }}>queued</option>
		  <option value="running" {{ 'selected' if status=='running' else '' }}>running</option>
		  <option value="failed" {{ 'selected' if status=='failed' else '' }}>failed</option>
		  <option value="completed" {{ 'selected' if status=='completed' else '' }}>completed</option>
		  <option value="cancelled" {{ 'selected' if status=='cancelled' else '' }}>cancelled</option>
		</select>	  
        <select name="sort">
          <option value="created_at" {{ 'selected' if sort=='created_at' else '' }}>Sort by created_at</option>
          <option value="request" {{ 'selected' if sort=='request' else '' }}>Sort by request</option>
        </select>
        <select name="order">
          <option value="desc" {{ 'selected' if order=='desc' else '' }}>Desc</option>
          <option value="asc"  {{ 'selected' if order=='asc' else '' }}>Asc</option>
        </select>
        <input type="number" name="limit" value="{{ limit }}" min="1" max="100" style="width:100px;">
        <button type="submit">Apply</button>
      </div>
    </div>
  </form>
</div>

<div id="plans-table" hx-swap="outerHTML" style="margin-top:12px;">
  {% include "plans_list_table.html" %}
</div>
{% endblock %}
