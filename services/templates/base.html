<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{{ title or "Planner UI" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="{{ url_for('static', path='site.css') }}" rel="stylesheet" />
    <script src="https://unpkg.com/htmx.org@1.9.12" defer integrity="sha384-0o0vW5KkqLQhGxSsJmK3Zt1i8q9dZ/3t9XQwP0V8H4s8U7bW1W86vZ3Y8XgP7Xxj" crossorigin="anonymous"></script>
  </head>
  <body>
  <div id="flash"></div>
  <span style="flex:1"></span>
  <nav style="display:inline-block;">
    {% if request.state.user and request.state.user.id != 'public' %}
      <span>Signed in as {{ request.state.user.email }}</span>
      <a href="/ui/logout" style="margin-left:.75rem">Logout</a>
    {% else %}
      <a href="/ui/login">Login</a>
      <a href="/ui/register" style="margin-left:.75rem">Register</a>
    {% endif %}
  </nav>
    <div class="container">
      {% block content %}{% endblock %}
    </div>
  </body>
</html>
<script>
  document.body.addEventListener('htmx:responseError', function (evt) {
    // Fallback client-side banner when server couldn't render _flash.html
    const flash = document.getElementById('flash');
    if (flash) {
      flash.innerHTML = '<div class="flash error"><strong>Error</strong> <span style="margin-left:.5rem">Request failed.</span></div>';
    }
  });
</script>